# RStudio Exercise 2 - Analysis

[kommentti_1a]: <> (TÄMÄ ON RMarkdown KOMMENTTI)
[kommentti_1b]: <> (Tyhjä rivi saadaan <br>)

[kommentti_2]: <> (Alla lueteltu tarvittavat paketit)
[kommentti_3]: <> (install.packages("ggplot2"))
[kommentti_4]: <> (library(ggplot2))
[kommentti_5]: <> (install.packages("GGally"))
[kommentti_6]: <> (library(GGally))

<br><br>

### Task 1
<br>
**Task** *Read the students2014 data into R either from your local folder (if you completed the Data wrangling part) or from this url: http://s3.amazonaws.com/assets.datacamp.com/production/course_2218/datasets/learning2014.txt . (The separator is a comma "," and the file includes a header). Explore the structure and the dimensions of the data and describe the dataset briefly, assuming the reader has no previous knowledge of it. There is information related to the data here.*
<br><br>
```{r kohta1a}
students2014 <- read.table("http://s3.amazonaws.com/assets.datacamp.com/production/course_2218/datasets/learning2014.txt",sep=",",header=TRUE)
```
<br>
```{r kohta1b}
dim(students2014)
```
<br>
```{r kohta1c}
str(students2014)
```
<br>
Data frame students2014 includes 166 items and 7 variables. Variabels and their types have been listed above.
<br><br>

### Task 2
<br>
**Task** *Show a graphical overview of the data and show summaries of the variables in the data. Describe and interpret the outputs, commenting on the distributions of the variables and the relationships between them.*
<br><br>

```{r kohta2a}
attach(students2014)

plot(gender, border="dark blue", col="light blue", main="Amount of Women vs men", xlab="Women (F), men (M)")

summary(gender)
```
<br>
```{r kohta2b}
Nika <- subset(age, (gender == "F"))
hist(Nika, col="red", breaks=c(10,20,30,40,50,60), main="Woman - age, classified", xlab="age")
summary(Nika)
```
<br>
```{r kohta2c}
Mika <- subset(age, (gender == "M"))
hist(Mika, col="blue", breaks=c(10,20,30,40,50,60), main="Men - age, classified", xlab="age")
summary(Mika)
```
<br>
```{r kohta2d}
d <- density(students2014$attitude)
plot(d, main="Attitude distribution, total")
polygon(d, col="red", border="black")
```
<br><br>
```{r kohta2e}
library(ggplot2)
grades <- cut(students2014$points, breaks = c(0, 11, 15, 19, 23, 27, 33), include.lowest = TRUE)
qplot(grades, attitude, data=students2014, geom="boxplot", fill=grades, main="Grades vs attitude")
```
<br><br>
```{r kohta2f}
summary(students2014$attitude)
qplot(attitude, points, col = gender, main = "By gender, points vs attitude", data = students2014) + geom_smooth(method = "lm")
```
<br><br>
```{r kohta2g}
library(GGally)
ggpairs(students2014)
```
<br><br>
### Task 3
<br>
**Task** *Choose three variables as explanatory variables and fit a regression model where exam points is the target (dependent) variable. Show a summary of the fitted model and comment and interpret the results. Explain and interpret the statistical test related to the model parameters. If an explanatory variable in your model does not have a statistically significant relationship with the target variable, remove the variable from the model and fit the model again without it.*
<br><br>
We'll get three explanatory variables from last picture in the previous section. Three variables that correlates most with exam points are attitude (0.437), stra (0.146) and surf (-0.144).
<br><br>
```{r kohta3a}
model1 <- lm(points ~ attitude + stra + surf, data=students2014)
summary(model1)
```
<br>
Variable surf's p-value 0.46563 is much greater than 0.05 so we drop it from model.
<br><br>
```{r kohta3b}
model2 <- lm(points ~ attitude + stra)
summary(model2)
```
<br>
Variable stra's p-value 0.08927 is also not approvable, becaus is greater than 0.05.
<br><br>
```{r kohta3c}
model <- lm(points ~ attitude)
summary(model)
```
<br>
Now model is ready. Variable attitude's p-value is much smaller than 0.05. Model inculdes only one variable(attitude).
<br><br>

### Task 4
<br>
**Task** *Using a summary of your fitted model, explain the relationship between the chosen explanatory variables and the target variable (interpret the model parameters). Explain and interpret the multiple R squared of the model.*
<br><br>
Summary table can be found above (previous report). 
<br>
There is statistical responsibilty between points and attitude. This can be interpreted from attitude's p-value which is much smaller than 0.05. Attitude variables coefficient is 3.5255. This mean that when attitude grows one unit, points grows about 3.53 unit. In this model there is only one explanatory variable attitude. Attitudes coefficient qualifies the relationship between points and attitude. 
<br><br>

### Task 5
<br>
**Task** *Produce the following diagnostic plots: Residuals vs Fitted values, Normal QQ-plot and Residuals vs Leverage. Explain the assumptions of the model and interpret the validity of those assumptions based on the diagnostic plots.*
<br><br>
```{r kohta5a}
par(mfrow = c(2,2))
plot(model, which = c(1,2,5))
```